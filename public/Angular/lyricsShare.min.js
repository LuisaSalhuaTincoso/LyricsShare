(function(){angular.module("lyricsShareApp",["ngRoute"]);function e(e,r){e.when("/",{templateUrl:"home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/detalle/:publishid",{templateUrl:"/publishDetail/publishDetail.view.html",controller:"publishDetailCtrl",controllerAs:"vm"}).when("/registro",{templateUrl:"/auth/register/register.view.html",controller:"registroCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"/auth/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).when("/crear",{templateUrl:"/publishCreate/publishCreate.view.html",controller:"publishCreateCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"});r.html5Mode(true)}angular.module("lyricsShareApp").config(["$routeProvider","$locationProvider",e])})();(function(){angular.module("lyricsShareApp").controller("homeCtrl",e);e.$inject=["$scope","lyricsShareData"];function e(e,r){var t=this;t.pageHeader={title:"Loc8r",strapline:"Find places to work with wifi near you!"};t.sidebar={content:"Looking for wifi and a seat etc etc"};t.message="Checking your location";t.message="Searching for nearby places";r.listPublishById().success(function(e){t.message=e.length>0?"":"No publish found nearby";t.data={publish:e}}).error(function(e){t.message="Sorry, something's gone wrong"})}})();(function(){angular.module("lyricsShareApp").controller("registroCtrl",e);e.$inject=["$location","authentication"];function e(e,r){var t=this;t.pageHeader={title:"Create a new Loc8r account"};t.credentials={user_name:"",email:"",password:""};t.returnPage=e.search().page||"/";t.onSubmit=function(){t.formError="";if(!t.credentials.user_name||!t.credentials.email||!t.credentials.password){t.formError="All fields required, please try again";return false}else{t.doRegister()}};t.doRegister=function(){t.formError="";r.register(t.credentials).error(function(e){t.formError=e}).then(function(){e.search("page",null);e.path(t.returnPage)})}}})();(function(){angular.module("lyricsShareApp").controller("loginCtrl",e);e.$inject=["$location","authentication"];function e(e,r){var t=this;t.pageHeader={title:"Sign in to Loc8r"};t.credentials={email:"",password:""};t.returnPage=e.search().page||"/";t.onSubmit=function(){t.formError="";if(!t.credentials.email||!t.credentials.password){t.formError="All fields required, please try again";return false}else{t.doLogin()}};t.doLogin=function(){t.formError="";r.login(t.credentials).error(function(e){t.formError=e}).then(function(){e.search("page",null);e.path(t.returnPage)})}}})();(function(){angular.module("lyricsShareApp").controller("publishDetailCtrl",e);e.$inject=["$routeParams","lyricsShareData"];function e(e,r){var t=this;t.publishid=e.publishid;r.publishById(t.publishid).success(function(e){t.data={publish:e};t.pageHeader={title:t.data.publish.song.titulo}}).error(function(e){console.log(e)})}})();(function(){angular.module("lyricsShareApp").controller("publishCreateCtrl",e);e.$inject=["$location","publishCreate","authentication"];function e(e,r,t){var n=this;n.pageHeader={title:"Create a new Publish"};n.body={user_name:t.currentUser().name,titulo:"",genres:"",autor:"",album:"",track:"",lyrics:""};n.returnPage="/";n.onSubmit=function(){n.formError="";if(!n.body.user_name||!n.body.titulo||!n.body.lyrics||!n.body.track){n.formError="All fields required, please try again";return false}else{n.doCreate(n.body)}};n.doCreate=function(t){n.formError="";r.create(t).then(function(){e.path(n.returnPage)})}}})();(function(){angular.module("lyricsShareApp").service("lyricsShareData",e);e.$inject=["$http"];function e(e){var r=function(){return e.get("/api/publish")};var t=function(r){return e.get("/api/publish/"+r)};return{listPublishById:r,publishById:t}}})();(function(){angular.module("lyricsShareApp").service("authentication",e);e.$inject=["$http","$window"];function e(e,r){var t=function(e){r.localStorage["lyricsShare-token"]=e};var n=function(){return r.localStorage["lyricsShare-token"]};var i=function(){var e=n();if(e){var t=JSON.parse(r.atob(e.split(".")[1]));return t.exp>Date.now()/1e3}else{return false}};var o=function(){if(i()){var e=n();var t=JSON.parse(r.atob(e.split(".")[1]));return{email:t.email,name:t.name}}};register=function(r){return e.post("/api/registro",r).success(function(e){t(e.token)})};login=function(r){return e.post("/api/login",r).success(function(e){t(e.token)})};logout=function(){r.localStorage.removeItem("lyricsShare-token")};return{currentUser:o,saveToken:t,getToken:n,isLoggedIn:i,register:register,login:login,logout:logout}}})();(function(){angular.module("lyricsShareApp").service("publishCreate",e);e.$inject=["$http","$window"];function e(e,r){create=function(r){var t=e.post("/api/publish",r).success(function(e){console.log({image:r.image,name:e._id})});return t};return{create:create}}})();(function(){angular.module("lyricsShareApp").controller("navigationCtrl",e);e.$inject=["$location","$route","authentication"];function e(e,r,t){var n=this;n.currentPath=e.path();n.isLoggedIn=t.isLoggedIn();n.currentUser=t.currentUser();n.logout=function(){t.logout();e.path("/");r.reload()}}})();(function(){angular.module("lyricsShareApp").directive("fileModel",e);e.$inject=["$parse"];function e(e){return{restrict:"A",link:function(r,t,n){var i=e(n.fileModel);var o=i.assign;t.bind("change",function(){r.$apply(function(){o(r,t[0].files[0])})})}}}})();(function(){angular.module("lyricsShareApp").directive("navigation",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html",controller:"navigationCtrl as navvm"}}})();(function(){angular.module("lyricsShareApp").directive("footerGeneric",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/footerGeneric/footerGeneric.template.html"}}})();